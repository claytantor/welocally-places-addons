function WELOCALLY_WpPager(a){this.cfg;this.wrapper;this.init=function(){var c=this.initCfg(a);var b=jQuery("SCRIPT");b=b[b.length-1];if(c){jQuery(b).parent().before('<div class="error">Error during configiration: '+c[0]+"</div>")}else{this.makeWrapper();this.getMetadata();this.load(1);jQuery(b).parent().before(this.wrapper)}return this}}WELOCALLY_WpPager.prototype.initCfg=function(a){var b=[];if(!a){b.push("Please provide configuration for the widget.");a={}}if(!a.table){b.push("A table name is required to make a query.")}if(!a.fields){b.push("Please specifiy which fields tou would like to query.")}if(!a.page){a.page=1}if(!a.pagesize){a.pagesize=10}if(!a.content){b.push("The content template is required.")}if(b.length>0){return b}this.cfg=a};WELOCALLY_WpPager.prototype.makeWrapper=function(){var b=this;var d=jQuery("<div></div>");jQuery(d).css("display","none");jQuery(d).attr("class","wl_pager_wrapper");jQuery(d).attr("id","wl_pager_wrapper_"+b.cfg.id);this.statusArea=jQuery("<div></div>");jQuery(this.ajaxStatus).css("display","none");jQuery(d).append(this.statusArea);var a=jQuery("<div></div>");jQuery(a).attr("class","wl_pager_control");jQuery(a).attr("id","wl_pager_control_top_"+b.cfg.id);jQuery(d).append(a);var c=jQuery("<div></div>");jQuery(c).attr("class","wl_pager_content");jQuery(c).attr("id","wl_pager_content_"+b.cfg.id);jQuery(d).append(c);this.wrapper=d;return d};WELOCALLY_WpPager.prototype.getMetadata=function(){var a=this;var b={action:"get_metadata",table:a.cfg.table,fields:a.cfg.fields,filter:a.cfg.filter,orderBy:a.cfg.orderBy,pagesize:a.cfg.pagesize};a.jqxhr=jQuery.ajax({type:"POST",url:a.cfg.ajaxurl,data:b,beforeSend:function(c){a.jqxhr=c},error:function(c,e,d){if(e!="abort"){a.setStatus(a.statusArea,"ERROR : "+e,"wl_error",false)}},success:function(d,f,e){var c=jQuery.parseJSON(d);c.current=1;a.setupPaginationMetadata(c)}})};WELOCALLY_WpPager.prototype.setupPaginationMetadata=function(b){var a=this;a.metadata=b;jQuery(a.wrapper).find(".wl_pager_control").html(a.paginationInterfaceGenerator(a))};WELOCALLY_WpPager.prototype.pageHandler=function(c,e){var a=c.data.instance;var d=c.data.page;a.metadata.current=d;a.load(d);var b=a.paginationInterfaceGenerator(c.data.instance);jQuery(a.wrapper).find(".wl_pager_control").html(b);return false};WELOCALLY_WpPager.prototype.bindPageLink=function(d,c,e){var a=this;var b=jQuery('<li><a href="#">'+e+"</a></li>");jQuery(b).find("a").bind("click",{instance:a,page:c},a.pageHandler);jQuery(d).append(b)};WELOCALLY_WpPager.prototype.paginationInterfaceGenerator=function(i){var k=i;var h=2;var g=(k.metadata.current==0?1:k.metadata.current);var b=(g-1)*25;var d=g-1;var e=g+1;var c=k.metadata.pages;var a=c-1;var j=jQuery('<div style="margin:0px;padding:0px;"></div>');if(c>1){var f=jQuery('<ul class="pagination"></ul>');jQuery(f).append('<li class="wl_pager_pages details">Page '+g+" of "+c+"</li>");if(c<7+(h*2)){for(counter=1;counter<=c;counter++){if(counter==g){jQuery(f).append('<li><a class="current">'+counter+"</a></li>")}else{k.bindPageLink(f,counter,counter)}}}else{if(c>5+(h*2)){if(g<1+(h*2)){for(counter=1;counter<4+(h*2);counter++){if(counter==g){jQuery(f).append('<li><a class="current">'+counter+"</a></li>")}else{k.bindPageLink(f,counter,counter)}}jQuery(f).append('<li class="dot">...</li>');k.bindPageLink(f,a,a);k.bindPageLink(f,c,c)}else{if(c-(h*2)>g&&g>(h*2)){k.bindPageLink(f,1,1);k.bindPageLink(f,2,2);jQuery(f).append('<li class="dot">...</li>');for(counter=g-h;counter<=g+h;counter++){if(counter==g){jQuery(f).append("<li><a class='current'>"+counter+"</a></li>")}else{k.bindPageLink(f,counter,counter)}}jQuery(f).append("<li class='dot'>..</li>");k.bindPageLink(f,a,a);k.bindPageLink(f,c,c)}else{k.bindPageLink(f,1,1);k.bindPageLink(f,2,2);jQuery(f).append("<li class='dot'>..</li>");for(counter=c-(2+(h*2));counter<=c;counter++){if(counter==g){jQuery(f).append("<li><a class='current'>"+counter+"</a></li>")}else{k.bindPageLink(f,counter,counter)}}}}if(g<counter-1){k.bindPageLink(f,e,"Next");k.bindPageLink(f,c,"Last")}else{jQuery(f).append("<li><a class='current'>Next</a></li>");jQuery(f).append("<li><a class='current'>Last</a></li>")}}}jQuery(j).append(f)}return j};WELOCALLY_WpPager.prototype.load=function(c){var a=this;var b={action:"getpage",table:a.cfg.table,fields:a.cfg.fields,filter:a.cfg.filter,orderBy:a.cfg.orderBy,odd:a.cfg.odd,even:a.cfg.even,pagesize:a.cfg.pagesize,page:c,content:a.cfg.content};a.jqxhr=jQuery.ajax({type:"POST",url:a.cfg.ajaxurl,data:b,beforeSend:function(d){a.jqxhr=d;a.setStatus(a.statusArea,"Loading...","wl_message",false)},error:function(d,f,e){if(f!="abort"){a.setStatus(a.statusArea,"ERROR : "+f,"wl_error",false)}},success:function(d,f,e){a.setStatus(a.statusArea,"","wl_message",false);jQuery(a.wrapper).find(".wl_pager_content").html(d);jQuery(a.wrapper).show()}})};WELOCALLY_WpPager.prototype.updateSearch=function(a){this.initCfg(a);this.getMetadata();this.load(1)};WELOCALLY_WpPager.prototype.setStatus=function(c,d,b,a){jQuery(c).html("");jQuery(c).removeClass();jQuery(c).addClass(b);jQuery(c).append(d);if(d!=""){jQuery(c).show()}else{jQuery(c).hide()}};